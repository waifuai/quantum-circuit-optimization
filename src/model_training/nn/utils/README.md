# Utils Folder

This folder contains common utility modules that support the main project scripts by providing reusable functions for creating quantum circuits and building deep neural network (DNN) models.

## Modules

### circuit_utils.py

This module provides helper functions related to quantum circuits using Cirq.

- **`create_circuit(params, qubits=None)`**  
  Creates a parameterized quantum circuit.  
  - **Parameters:**  
    - `params`: A list or array of parameters for the circuit gates.
    - `qubits`: An optional list of qubits. If not provided, the function defaults to a 5-qubit register.
  - **Returns:**  
    - A `cirq.Circuit` object that has been constructed with parameterized RX gates and CNOT operations.

- **`calculate_loss(circuit, target_state)`**  
  Computes the loss (defined as 1 - fidelity) between the simulated final state of the quantum circuit and a given target state.
  - **Parameters:**  
    - `circuit`: The `cirq.Circuit` instance to simulate.
    - `target_state`: The target state vector to compare against.
  - **Returns:**  
    - A numerical loss value where a lower value indicates higher fidelity.

### model_utils.py

This module provides helper functions for building deep neural network models with TensorFlow.

- **`create_dnn_model(input_dim, num_params, dense_units=128, num_layers=3)`**  
  Creates and returns a DNN model that outputs circuit parameters based on an input feature vector.
  - **Parameters:**  
    - `input_dim`: The number of features in the input layer.
    - `num_params`: The number of parameters (e.g., circuit parameters) that the model should output.
    - `dense_units`: (Optional) The number of neurons in each hidden Dense layer (default is 128).
    - `num_layers`: (Optional) The number of hidden Dense layers (default is 3).
  - **Returns:**  
    - A compiled TensorFlow Keras Model instance that can be used to generate quantum circuit parameters.

## Usage

The functions in this folder are designed to be imported and used by other parts of the project. For example:

```python
from utils.circuit_utils import create_circuit, calculate_loss
from utils.model_utils import create_dnn_model

# Create a quantum circuit using parameters generated by some process.
params = [0.5] * 25  # Example parameter vector
circuit = create_circuit(params)
print("Quantum Circuit:")
print(circuit)

# Build a DNN model for generating circuit parameters.
input_dim = 287  # Example input dimension (adjust to your feature count)
num_params = 25  # 5 layers * 5 qubits
dnn_model = create_dnn_model(input_dim, num_params)
dnn_model.summary()
```

## Dependencies

- [Cirq](https://quantumai.google/cirq) – For creating and simulating quantum circuits.
- [TensorFlow](https://www.tensorflow.org/) – For building and training deep neural network models.

## Notes

- These modules are designed to be modular and reusable.  
- You can extend or modify these functions based on your project requirements (e.g., adding more complex circuit elements or network layers).
- Ensure that your main project scripts properly reference this utils folder in your project’s directory structure.
